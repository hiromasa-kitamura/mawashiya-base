<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Bridge｜アトツギ支援アプリ</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+JP:wght@300;400;500;700;900&family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
  <style>
    /* ===== Reset & Variables ===== */
    *, *::before, *::after { margin: 0; padding: 0; box-sizing: border-box; }

    :root {
      /* Warm (Sendai) */
      --amber: #e6920a;
      --amber-light: #d97706;
      --amber-glow: rgba(217, 119, 6, 0.18);
      --coral: #ea580c;
      --coral-light: #dc5a0b;
      --coral-glow: rgba(234, 88, 12, 0.15);
      --warm-red: #dc2626;

      /* Cool (Atotugi) */
      --cyan: #0891b2;
      --cyan-light: #0e7490;
      --cyan-glow: rgba(8, 145, 178, 0.18);
      --indigo: #4f46e5;
      --indigo-light: #4338ca;
      --indigo-glow: rgba(79, 70, 229, 0.15);
      --blue: #2563eb;

      /* Success */
      --green: #16a34a;
      --green-light: #15803d;
      --green-glow: rgba(22, 163, 74, 0.15);

      /* Light theme base */
      --dark-bg: #f0f4f8;
      --dark-surface: #e8edf3;
      --dark-card: rgba(255, 255, 255, 0.7);
      --dark-card-border: rgba(0, 0, 0, 0.06);
      --dark-card-hover: rgba(255, 255, 255, 0.9);
      --text-primary: #1a2332;
      --text-secondary: rgba(26, 35, 50, 0.6);
      --text-muted: rgba(26, 35, 50, 0.38);

      /* Glass - light mode */
      --glass-bg: rgba(255, 255, 255, 0.55);
      --glass-border: rgba(255, 255, 255, 0.7);
      --glass-blur: 20px;

      --radius-sm: 8px;
      --radius-md: 14px;
      --radius-lg: 20px;
      --radius-xl: 28px;

      --font-jp: 'Noto Sans JP', sans-serif;
      --font-en: 'Inter', sans-serif;
    }

    html { scroll-behavior: smooth; font-size: 16px; }

    body {
      font-family: var(--font-jp);
      color: var(--text-primary);
      background: linear-gradient(135deg, #f0f4f8 0%, #e0e8f0 30%, #dce4f0 60%, #eaeff5 100%);
      line-height: 1.7;
      -webkit-font-smoothing: antialiased;
      overflow-x: hidden;
      min-height: 100vh;
    }

    /* ===== Aurora Background ===== */
    .aurora-bg {
      position: fixed; inset: 0; z-index: 0;
      overflow: hidden; pointer-events: none;
    }

    .aurora-orb {
      position: absolute; border-radius: 50%;
      filter: blur(80px);
      animation: orbFloat 12s ease-in-out infinite;
    }

    .aurora-orb--1 {
      width: 500px; height: 500px;
      background: radial-gradient(circle, rgba(147, 197, 253, 0.35), transparent 70%);
      top: -10%; left: -10%; animation-duration: 15s;
    }
    .aurora-orb--2 {
      width: 600px; height: 600px;
      background: radial-gradient(circle, rgba(196, 181, 253, 0.25), transparent 70%);
      top: 30%; right: -15%; animation-duration: 18s; animation-delay: -5s;
    }
    .aurora-orb--3 {
      width: 400px; height: 400px;
      background: radial-gradient(circle, rgba(103, 232, 249, 0.25), transparent 70%);
      bottom: -5%; left: 20%; animation-duration: 14s; animation-delay: -8s;
    }
    .aurora-orb--4 {
      width: 350px; height: 350px;
      background: radial-gradient(circle, rgba(165, 180, 252, 0.3), transparent 70%);
      top: 50%; left: 50%; animation-duration: 16s; animation-delay: -3s;
    }

    .mode-sendai .aurora-orb--1 { opacity: 1; width: 700px; height: 700px; background: radial-gradient(circle, rgba(251, 191, 36, 0.2), transparent 70%); }
    .mode-sendai .aurora-orb--2 { opacity: 0.9; background: radial-gradient(circle, rgba(251, 146, 60, 0.18), transparent 70%); }
    .mode-sendai .aurora-orb--3 { opacity: 0.3; }
    .mode-sendai .aurora-orb--4 { opacity: 0.2; }

    .mode-atotugi .aurora-orb--1 { opacity: 0.2; }
    .mode-atotugi .aurora-orb--2 { opacity: 0.3; }
    .mode-atotugi .aurora-orb--3 { opacity: 1; width: 600px; height: 600px; background: radial-gradient(circle, rgba(34, 211, 238, 0.2), transparent 70%); }
    .mode-atotugi .aurora-orb--4 { opacity: 0.9; width: 500px; height: 500px; background: radial-gradient(circle, rgba(129, 140, 248, 0.22), transparent 70%); }

    @keyframes orbFloat {
      0%, 100% { transform: translate(0, 0) scale(1); }
      33% { transform: translate(30px, -40px) scale(1.05); }
      66% { transform: translate(-20px, 20px) scale(0.95); }
    }

    /* ===== Floating Particles ===== */
    .particles { position: fixed; inset: 0; z-index: 0; pointer-events: none; }
    .particle {
      position: absolute; border-radius: 50%;
      animation: particleFloat linear infinite;
    }
    @keyframes particleFloat {
      0% { transform: translateY(100vh) scale(0); opacity: 0; }
      10% { opacity: 1; }
      90% { opacity: 1; }
      100% { transform: translateY(-10vh) scale(1); opacity: 0; }
    }

    /* ===== App Container ===== */
    .app { position: relative; z-index: 1; min-height: 100vh; display: flex; flex-direction: column; }

    /* ===== Glass Card ===== */
    .glass {
      background: var(--glass-bg);
      backdrop-filter: blur(var(--glass-blur));
      -webkit-backdrop-filter: blur(var(--glass-blur));
      border: 1px solid var(--glass-border);
      border-radius: var(--radius-lg);
    }

    .glass-strong {
      background: rgba(255, 255, 255, 0.75);
      backdrop-filter: blur(30px);
      -webkit-backdrop-filter: blur(30px);
      border: 1px solid rgba(255, 255, 255, 0.85);
      box-shadow: 0 4px 24px rgba(0, 0, 0, 0.04);
    }

    /* ===== Screens ===== */
    .screen { display: none; animation: fadeIn 0.5s ease; }
    .screen.active { display: flex; flex-direction: column; min-height: 100vh; }
    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(12px); }
      to { opacity: 1; transform: translateY(0); }
    }

    /* ===== Role Selection Screen ===== */
    .role-screen {
      align-items: center; justify-content: center;
      padding: 40px 24px; text-align: center;
    }
    .role-screen .app-logo { margin-bottom: 12px; }
    .app-logo-text {
      font-family: var(--font-en); font-size: 2.4rem; font-weight: 700;
      letter-spacing: 0.08em;
      background: linear-gradient(135deg, #2563eb, #4f46e5, #7c3aed);
      -webkit-background-clip: text; -webkit-text-fill-color: transparent; background-clip: text;
    }
    .app-tagline {
      font-size: 0.88rem; color: var(--text-muted);
      margin-bottom: 56px; line-height: 1.8;
    }
    .role-cards { display: grid; grid-template-columns: 1fr 1fr; gap: 24px; max-width: 700px; width: 100%; }
    .role-card {
      padding: 48px 32px; border-radius: var(--radius-xl); cursor: pointer;
      transition: all 0.4s cubic-bezier(0.25, 0.46, 0.45, 0.94);
      position: relative; overflow: hidden; text-align: center;
    }
    .role-card::before {
      content: ''; position: absolute; inset: 0;
      border-radius: var(--radius-xl); padding: 1.5px;
      background: linear-gradient(135deg, transparent, transparent);
      -webkit-mask: linear-gradient(#fff 0 0) content-box, linear-gradient(#fff 0 0);
      mask: linear-gradient(#fff 0 0) content-box, linear-gradient(#fff 0 0);
      -webkit-mask-composite: xor; mask-composite: exclude;
      transition: all 0.4s ease;
    }
    .role-card--sendai { background: rgba(255, 255, 255, 0.6); border: 1px solid rgba(217, 119, 6, 0.2); }
    .role-card--sendai:hover {
      background: rgba(255, 255, 255, 0.85); border-color: rgba(217, 119, 6, 0.35);
      transform: translateY(-6px); box-shadow: 0 20px 60px rgba(217, 119, 6, 0.12);
    }
    .role-card--sendai::before { background: linear-gradient(135deg, var(--amber), var(--coral)); }
    .role-card--atotugi { background: rgba(255, 255, 255, 0.6); border: 1px solid rgba(8, 145, 178, 0.2); }
    .role-card--atotugi:hover {
      background: rgba(255, 255, 255, 0.85); border-color: rgba(8, 145, 178, 0.35);
      transform: translateY(-6px); box-shadow: 0 20px 60px rgba(8, 145, 178, 0.12);
    }
    .role-card--atotugi::before { background: linear-gradient(135deg, var(--cyan), var(--indigo)); }
    .role-card:hover::before { opacity: 1; }
    .role-icon {
      width: 72px; height: 72px; margin: 0 auto 20px; border-radius: 50%;
      display: flex; align-items: center; justify-content: center; font-size: 2rem;
    }
    .role-card--sendai .role-icon { background: rgba(217, 119, 6, 0.1); }
    .role-card--atotugi .role-icon { background: rgba(8, 145, 178, 0.1); }
    .role-title { font-size: 1.3rem; font-weight: 700; margin-bottom: 4px; }
    .role-card--sendai .role-title { color: var(--amber-light); }
    .role-card--atotugi .role-title { color: var(--cyan-light); }
    .role-label { font-size: 0.78rem; color: var(--text-muted); margin-bottom: 16px; }
    .role-desc { font-size: 0.85rem; color: var(--text-secondary); line-height: 1.8; }

    /* ===== Top Bar ===== */
    .topbar {
      position: sticky; top: 0; z-index: 50;
      padding: 16px 24px; display: flex; align-items: center; justify-content: space-between;
      background: rgba(255, 255, 255, 0.75);
      backdrop-filter: blur(20px); -webkit-backdrop-filter: blur(20px);
      border-bottom: 1px solid rgba(0, 0, 0, 0.06);
    }
    .topbar-logo {
      font-family: var(--font-en); font-size: 1rem; font-weight: 600; letter-spacing: 0.06em;
      background: linear-gradient(135deg, var(--blue), var(--indigo));
      -webkit-background-clip: text; -webkit-text-fill-color: transparent; background-clip: text;
    }
    .topbar-back {
      display: flex; align-items: center; gap: 6px; font-size: 0.82rem;
      color: var(--text-secondary); background: none; border: none; cursor: pointer;
      padding: 8px 16px; border-radius: var(--radius-sm);
      transition: all 0.2s; font-family: var(--font-jp);
    }
    .topbar-back:hover { color: var(--text-primary); background: var(--glass-bg); }
    .topbar-back svg { width: 16px; height: 16px; }

    /* ===== Buttons ===== */
    .btn {
      display: inline-flex; align-items: center; gap: 8px;
      padding: 12px 28px; border: none; border-radius: var(--radius-md);
      font-family: var(--font-jp); font-size: 0.88rem; font-weight: 600;
      cursor: pointer; transition: all 0.3s ease; letter-spacing: 0.02em;
    }
    .btn svg { width: 16px; height: 16px; }
    .btn-primary {
      background: linear-gradient(135deg, var(--amber), var(--coral));
      color: #fff; box-shadow: 0 4px 20px var(--amber-glow);
    }
    .btn-primary:hover { transform: translateY(-2px); box-shadow: 0 8px 30px var(--amber-glow); }
    .btn-primary--cool {
      background: linear-gradient(135deg, var(--cyan), var(--indigo));
      box-shadow: 0 4px 20px var(--cyan-glow);
    }
    .btn-primary--cool:hover { box-shadow: 0 8px 30px var(--cyan-glow); }
    .btn-secondary {
      background: var(--glass-bg); border: 1px solid var(--glass-border);
      color: var(--text-secondary);
    }
    .btn-secondary:hover { background: var(--dark-card-hover); color: var(--text-primary); }
    .btn:disabled { opacity: 0.4; cursor: not-allowed; transform: none !important; }
    .btn-outline-cool {
      background: transparent; border: 1px solid rgba(6, 182, 212, 0.3);
      color: var(--cyan-light);
    }
    .btn-outline-cool:hover { background: rgba(6, 182, 212, 0.1); border-color: rgba(6, 182, 212, 0.5); }

    /* ===== Interview ===== */
    .interview-container { flex: 1; max-width: 720px; margin: 0 auto; padding: 40px 24px; width: 100%; }
    .interview-progress { margin-bottom: 40px; }
    .interview-progress-bar { height: 3px; background: rgba(0,0,0,0.06); border-radius: 2px; overflow: hidden; margin-bottom: 12px; }
    .interview-progress-fill { height: 100%; border-radius: 2px; transition: width 0.5s ease; }
    .interview-progress-fill--warm { background: linear-gradient(90deg, var(--amber), var(--coral)); }
    .interview-progress-fill--cool { background: linear-gradient(90deg, var(--cyan), var(--indigo)); }
    .interview-progress-text { display: flex; justify-content: space-between; font-size: 0.75rem; color: var(--text-muted); }
    .interview-theme-label {
      display: inline-flex; align-items: center; gap: 8px;
      padding: 6px 16px; border-radius: var(--radius-sm);
      font-size: 0.75rem; font-weight: 500; margin-bottom: 20px;
    }
    .interview-theme-label--warm { background: rgba(217, 119, 6, 0.08); border: 1px solid rgba(217, 119, 6, 0.2); color: var(--amber-light); }
    .interview-theme-label--cool { background: rgba(8, 145, 178, 0.08); border: 1px solid rgba(8, 145, 178, 0.2); color: var(--cyan-light); }
    .interview-question-num { font-family: var(--font-en); font-size: 0.7rem; font-weight: 600; color: var(--text-muted); letter-spacing: 0.1em; margin-bottom: 8px; }
    .interview-question { font-size: 1.2rem; font-weight: 700; color: var(--text-primary); line-height: 1.7; margin-bottom: 28px; }
    .interview-options { display: flex; flex-direction: column; gap: 10px; margin-bottom: 24px; }
    .interview-option {
      display: flex; align-items: center; gap: 14px; padding: 16px 20px;
      border-radius: var(--radius-md); background: var(--glass-bg);
      border: 1px solid var(--glass-border); cursor: pointer;
      transition: all 0.25s ease; font-size: 0.9rem; color: var(--text-primary);
    }
    .interview-option:hover { background: rgba(217, 119, 6, 0.06); border-color: rgba(217, 119, 6, 0.25); }
    .interview-option.selected { background: rgba(217, 119, 6, 0.08); border-color: rgba(217, 119, 6, 0.4); }
    .interview-option--cool:hover { background: rgba(8, 145, 178, 0.06); border-color: rgba(8, 145, 178, 0.25); }
    .interview-option--cool.selected { background: rgba(8, 145, 178, 0.08); border-color: rgba(8, 145, 178, 0.4); }
    .interview-option-radio {
      width: 20px; height: 20px; border-radius: 50%;
      border: 2px solid rgba(0,0,0,0.15);
      display: flex; align-items: center; justify-content: center;
      flex-shrink: 0; transition: all 0.25s;
    }
    .interview-option.selected .interview-option-radio { border-color: var(--amber); background: var(--amber); }
    .interview-option--cool.selected .interview-option-radio { border-color: var(--cyan); background: var(--cyan); }
    .interview-option.selected .interview-option-radio::after,
    .interview-option--cool.selected .interview-option-radio::after {
      content: ''; width: 8px; height: 8px; border-radius: 50%; background: #fff;
    }
    .interview-textarea {
      width: 100%; min-height: 120px; padding: 16px 20px;
      background: var(--glass-bg); border: 1px solid var(--glass-border);
      border-radius: var(--radius-md); color: var(--text-primary);
      font-family: var(--font-jp); font-size: 0.9rem; line-height: 1.8;
      resize: vertical; outline: none; transition: border-color 0.3s;
    }
    .interview-textarea:focus { border-color: rgba(217, 119, 6, 0.4); }
    .interview-textarea--cool:focus { border-color: rgba(8, 145, 178, 0.4); }
    .interview-textarea::placeholder { color: var(--text-muted); }
    .interview-textarea-label { font-size: 0.82rem; color: var(--text-secondary); margin-bottom: 10px; }
    .interview-nav { display: flex; justify-content: space-between; align-items: center; margin-top: 32px; gap: 16px; }

    /* ===== Interview Complete ===== */
    .interview-complete { text-align: center; padding: 80px 24px; max-width: 560px; margin: 0 auto; }
    .complete-icon {
      width: 80px; height: 80px; margin: 0 auto 24px; border-radius: 50%;
      background: linear-gradient(135deg, var(--amber), var(--coral));
      display: flex; align-items: center; justify-content: center; font-size: 2rem;
      animation: pulseGlow 2s ease-in-out infinite;
    }
    @keyframes pulseGlow {
      0%, 100% { box-shadow: 0 0 30px var(--amber-glow); }
      50% { box-shadow: 0 0 60px var(--amber-glow), 0 0 90px var(--coral-glow); }
    }
    .complete-title {
      font-size: 1.5rem; font-weight: 700; margin-bottom: 16px;
      background: linear-gradient(135deg, var(--amber), var(--coral));
      -webkit-background-clip: text; -webkit-text-fill-color: transparent; background-clip: text;
    }
    .complete-desc { font-size: 0.9rem; color: var(--text-secondary); line-height: 2; margin-bottom: 40px; }

    /* ===== Journey Stepper ===== */
    .stepper {
      display: flex; align-items: center; justify-content: center;
      gap: 0; padding: 24px 24px 8px; max-width: 600px; margin: 0 auto; width: 100%;
    }
    .stepper-step {
      display: flex; align-items: center; gap: 8px;
      font-size: 0.75rem; color: var(--text-muted); font-weight: 500;
      white-space: nowrap;
    }
    .stepper-step.active { color: var(--cyan-light); }
    .stepper-step.completed { color: var(--green-light); }
    .stepper-num {
      width: 24px; height: 24px; border-radius: 50%;
      display: flex; align-items: center; justify-content: center;
      font-family: var(--font-en); font-size: 0.65rem; font-weight: 700;
      background: rgba(0,0,0,0.04); border: 1px solid rgba(0,0,0,0.1);
      flex-shrink: 0;
    }
    .stepper-step.active .stepper-num {
      background: rgba(8, 145, 178, 0.12); border-color: var(--cyan);
      color: var(--cyan); box-shadow: 0 0 12px var(--cyan-glow);
    }
    .stepper-step.completed .stepper-num {
      background: rgba(22, 163, 74, 0.12); border-color: var(--green);
      color: var(--green);
    }
    .stepper-line {
      width: 32px; height: 1px; background: rgba(0,0,0,0.1);
      margin: 0 8px; flex-shrink: 0;
    }
    .stepper-line.completed { background: var(--green); }

    /* ===== Knowledge Base Screen (Step 0) ===== */
    .kb-container { flex: 1; max-width: 800px; margin: 0 auto; padding: 20px 24px 40px; width: 100%; }
    .kb-title { font-size: 1.3rem; font-weight: 700; margin-bottom: 4px; color: var(--text-primary); }
    .kb-subtitle { font-size: 0.85rem; color: var(--text-secondary); margin-bottom: 28px; line-height: 1.8; }
    .kb-stats { display: grid; grid-template-columns: repeat(3, 1fr); gap: 16px; margin-bottom: 28px; }
    .kb-stat {
      text-align: center; padding: 20px 16px; border-radius: var(--radius-md);
    }
    .kb-stat-num {
      font-family: var(--font-en); font-size: 1.8rem; font-weight: 700;
      background: linear-gradient(135deg, var(--cyan-light), var(--indigo-light));
      -webkit-background-clip: text; -webkit-text-fill-color: transparent; background-clip: text;
    }
    .kb-stat-label { font-size: 0.75rem; color: var(--text-muted); margin-top: 4px; }

    .kb-themes { display: grid; grid-template-columns: 1fr 1fr; gap: 16px; margin-bottom: 28px; }
    .kb-theme-card { padding: 20px; border-radius: var(--radius-md); }
    .kb-theme-icon { font-size: 1.3rem; margin-bottom: 8px; }
    .kb-theme-name { font-size: 0.88rem; font-weight: 600; color: var(--text-primary); margin-bottom: 6px; }
    .kb-theme-summary { font-size: 0.78rem; color: var(--text-secondary); line-height: 1.7; }

    .kb-highlight {
      padding: 20px 24px; border-radius: var(--radius-md);
      border-left: 3px solid var(--amber); margin-bottom: 28px;
      background: rgba(217, 119, 6, 0.06);
    }
    .kb-highlight-title { font-size: 0.85rem; font-weight: 600; color: var(--amber-light); margin-bottom: 6px; }
    .kb-highlight-desc { font-size: 0.82rem; color: var(--text-secondary); line-height: 1.8; }

    .kb-cta { text-align: center; }

    /* ===== Atotugi Survey Screen (Step 2) ===== */
    .survey-container { flex: 1; max-width: 720px; margin: 0 auto; padding: 20px 24px 40px; width: 100%; }

    /* ===== Results Screen (Step 3) ===== */
    .results-container { flex: 1; max-width: 800px; margin: 0 auto; padding: 20px 24px 40px; width: 100%; }
    .results-section-title {
      font-size: 1.1rem; font-weight: 700; margin-bottom: 20px;
      display: flex; align-items: center; gap: 10px;
    }
    .results-section-title span { font-size: 1.2rem; }

    /* Dual Radar */
    .dual-radar-container { display: flex; justify-content: center; margin-bottom: 16px; }
    .dual-radar { width: 320px; height: 320px; }
    .radar-legend {
      display: flex; justify-content: center; gap: 24px; margin-bottom: 32px;
      font-size: 0.78rem;
    }
    .radar-legend-item { display: flex; align-items: center; gap: 6px; }
    .radar-legend-dot { width: 10px; height: 10px; border-radius: 50%; }
    .radar-legend-dot--sendai { background: var(--amber); }
    .radar-legend-dot--atotugi { background: var(--cyan); }

    /* Gap Bars */
    .gap-bars { display: flex; flex-direction: column; gap: 16px; margin-bottom: 32px; }
    .gap-bar-item { padding: 16px 20px; border-radius: var(--radius-md); }
    .gap-bar-label {
      display: flex; justify-content: space-between; align-items: center;
      margin-bottom: 10px; font-size: 0.85rem; font-weight: 600;
    }
    .gap-bar-badge {
      font-family: var(--font-en); font-size: 0.7rem; font-weight: 600;
      padding: 2px 10px; border-radius: 20px;
    }
    .gap-bar-badge--good { background: rgba(22, 163, 74, 0.1); color: var(--green-light); }
    .gap-bar-badge--warn { background: rgba(217, 119, 6, 0.1); color: var(--amber-light); }
    .gap-bar-badge--danger { background: rgba(220, 38, 38, 0.1); color: #dc2626; }
    .gap-bar-track {
      position: relative; height: 8px; background: rgba(0,0,0,0.06);
      border-radius: 4px; overflow: visible;
    }
    .gap-bar-fill-sendai {
      position: absolute; top: 0; left: 0; height: 100%;
      background: linear-gradient(90deg, var(--amber), var(--coral));
      border-radius: 4px; opacity: 0.5;
    }
    .gap-bar-fill-atotugi {
      position: absolute; top: 0; left: 0; height: 100%;
      background: linear-gradient(90deg, var(--cyan), var(--indigo));
      border-radius: 4px;
    }
    .gap-bar-values {
      display: flex; justify-content: space-between; margin-top: 6px;
      font-size: 0.7rem; color: var(--text-muted);
    }

    /* Insight cards */
    .insight-cards { display: flex; flex-direction: column; gap: 16px; margin-bottom: 32px; }
    .insight-card { padding: 20px 24px; border-radius: var(--radius-md); }
    .insight-card-axis {
      font-size: 0.78rem; font-weight: 600; margin-bottom: 10px;
      display: flex; align-items: center; gap: 8px;
    }
    .insight-row {
      display: flex; gap: 12px; margin-bottom: 8px; font-size: 0.82rem; line-height: 1.7;
    }
    .insight-label {
      flex-shrink: 0; font-weight: 600; font-size: 0.72rem;
      padding: 2px 8px; border-radius: 4px; height: fit-content; margin-top: 2px;
    }
    .insight-label--sendai { background: rgba(217, 119, 6, 0.1); color: var(--amber-light); }
    .insight-label--you { background: rgba(8, 145, 178, 0.1); color: var(--cyan-light); }
    .insight-label--gap { background: rgba(79, 70, 229, 0.1); color: var(--indigo-light); }
    .insight-text { color: var(--text-secondary); }

    .summary-card { padding: 20px 24px; border-radius: var(--radius-md); margin-bottom: 16px; }
    .summary-card--strength { border-left: 3px solid var(--green); }
    .summary-card--warning { border-left: 3px solid var(--warm-red); }
    .summary-card-title {
      font-size: 0.88rem; font-weight: 600; margin-bottom: 8px;
      display: flex; align-items: center; gap: 8px;
    }
    .summary-card-body { font-size: 0.82rem; color: var(--text-secondary); line-height: 1.8; }

    .results-nav { display: flex; justify-content: center; gap: 16px; margin-top: 24px; }

    /* ===== Actions Screen (Step 4) ===== */
    .actions-container { flex: 1; max-width: 800px; margin: 0 auto; padding: 20px 24px 40px; width: 100%; }

    .action-cards { display: flex; flex-direction: column; gap: 16px; margin-bottom: 32px; }
    .action-card { padding: 20px 24px; border-radius: var(--radius-md); }
    .action-card-header {
      display: flex; justify-content: space-between; align-items: flex-start; margin-bottom: 10px;
    }
    .action-card-axis {
      font-size: 0.72rem; font-weight: 600; padding: 3px 10px;
      border-radius: 20px; background: rgba(8, 145, 178, 0.1); color: var(--cyan-light);
    }
    .action-card-priority {
      font-family: var(--font-en); font-size: 0.65rem; font-weight: 700;
      padding: 3px 10px; border-radius: 20px;
    }
    .action-card-priority--high { background: rgba(220, 38, 38, 0.1); color: #dc2626; }
    .action-card-priority--mid { background: rgba(217, 119, 6, 0.1); color: var(--amber-light); }
    .action-card-title { font-size: 0.92rem; font-weight: 600; margin-bottom: 6px; color: var(--text-primary); }
    .action-card-desc { font-size: 0.82rem; color: var(--text-secondary); line-height: 1.8; margin-bottom: 8px; }
    .action-card-meta { font-size: 0.72rem; color: var(--text-muted); display: flex; gap: 16px; }

    /* Timeline */
    .timeline { position: relative; padding-left: 28px; margin-bottom: 32px; }
    .timeline::before {
      content: ''; position: absolute; left: 10px; top: 0; bottom: 0;
      width: 2px; background: rgba(0,0,0,0.08);
    }
    .timeline-phase { position: relative; margin-bottom: 28px; }
    .timeline-phase:last-child { margin-bottom: 0; }
    .timeline-dot {
      position: absolute; left: -22px; top: 4px;
      width: 14px; height: 14px; border-radius: 50%;
      border: 2px solid; background: var(--dark-bg);
    }
    .timeline-phase--1 .timeline-dot { border-color: var(--cyan); box-shadow: 0 0 8px var(--cyan-glow); }
    .timeline-phase--2 .timeline-dot { border-color: var(--indigo); box-shadow: 0 0 8px var(--indigo-glow); }
    .timeline-phase--3 .timeline-dot { border-color: var(--green); box-shadow: 0 0 8px var(--green-glow); }
    .timeline-phase-header {
      font-size: 0.88rem; font-weight: 600; margin-bottom: 4px; color: var(--text-primary);
    }
    .timeline-phase-period {
      font-family: var(--font-en); font-size: 0.7rem; color: var(--text-muted); margin-bottom: 8px;
    }
    .timeline-phase-items { list-style: none; }
    .timeline-phase-items li {
      font-size: 0.82rem; color: var(--text-secondary); line-height: 1.8;
      padding-left: 16px; position: relative;
    }
    .timeline-phase-items li::before {
      content: ''; position: absolute; left: 0; top: 10px;
      width: 6px; height: 6px; border-radius: 50%;
      background: rgba(0,0,0,0.15);
    }

    .sendai-message {
      padding: 20px 24px; border-radius: var(--radius-md);
      border: 1px solid rgba(217, 119, 6, 0.2); background: rgba(217, 119, 6, 0.05);
      margin-bottom: 28px;
    }
    .sendai-message-title {
      font-size: 0.85rem; font-weight: 600; color: var(--amber-light); margin-bottom: 8px;
      display: flex; align-items: center; gap: 8px;
    }
    .sendai-message-body { font-size: 0.85rem; color: var(--text-secondary); line-height: 1.9; font-style: italic; }

    .actions-nav { display: flex; flex-wrap: wrap; justify-content: center; gap: 12px; }

    /* ===== Knowledge Browse Screen ===== */
    .knowledge-browse-container { flex: 1; max-width: 800px; margin: 0 auto; padding: 20px 24px 40px; width: 100%; }
    .knowledge-themes { display: flex; flex-direction: column; gap: 16px; }
    .knowledge-theme { border-radius: var(--radius-lg); overflow: hidden; }
    .knowledge-theme-header {
      display: flex; align-items: center; justify-content: space-between;
      padding: 20px 24px; cursor: pointer; transition: background 0.2s;
    }
    .knowledge-theme-header:hover { background: rgba(0,0,0,0.03); }
    .knowledge-theme-left { display: flex; align-items: center; gap: 14px; }
    .knowledge-theme-icon {
      width: 40px; height: 40px; border-radius: 10px;
      display: flex; align-items: center; justify-content: center; font-size: 1.1rem;
    }
    .knowledge-theme-icon--1 { background: rgba(217, 119, 6, 0.1); }
    .knowledge-theme-icon--2 { background: rgba(234, 88, 12, 0.1); }
    .knowledge-theme-icon--3 { background: rgba(8, 145, 178, 0.1); }
    .knowledge-theme-icon--4 { background: rgba(79, 70, 229, 0.1); }
    .knowledge-theme-name { font-size: 0.92rem; font-weight: 600; }
    .knowledge-theme-count { font-size: 0.75rem; color: var(--text-muted); }
    .knowledge-theme-arrow {
      width: 20px; height: 20px; color: var(--text-muted); transition: transform 0.3s;
    }
    .knowledge-theme.open .knowledge-theme-arrow { transform: rotate(180deg); }
    .knowledge-theme-body { max-height: 0; overflow: hidden; transition: max-height 0.4s ease; }
    .knowledge-theme.open .knowledge-theme-body { max-height: 2000px; }
    .knowledge-item { padding: 16px 24px 16px 78px; border-top: 1px solid rgba(0,0,0,0.06); }
    .knowledge-item-q { font-size: 0.82rem; font-weight: 600; color: var(--amber-light); margin-bottom: 6px; }
    .knowledge-item-type { font-size: 0.72rem; color: var(--text-muted); margin-bottom: 4px; }
    .knowledge-item-a { font-size: 0.85rem; color: var(--text-secondary); line-height: 1.8; }
    .knowledge-item-free {
      margin-top: 8px; padding: 12px 16px;
      background: rgba(217, 119, 6, 0.05);
      border-left: 2px solid rgba(217, 119, 6, 0.25);
      border-radius: 0 var(--radius-sm) var(--radius-sm) 0;
      font-size: 0.82rem; color: var(--text-secondary); line-height: 1.8; font-style: italic;
    }

    /* ===== Responsive ===== */
    @media (max-width: 640px) {
      .role-cards { grid-template-columns: 1fr; max-width: 360px; }
      .role-card { padding: 36px 24px; }
      .app-logo-text { font-size: 1.8rem; }
      .interview-question { font-size: 1.05rem; }
      .kb-stats { grid-template-columns: 1fr; }
      .kb-themes { grid-template-columns: 1fr; }
      .dual-radar { width: 260px; height: 260px; }
      .stepper { gap: 0; padding: 16px 12px 4px; }
      .stepper-step { font-size: 0.65rem; }
      .stepper-line { width: 16px; margin: 0 4px; }
    }
  </style>
</head>
<body>

  <!-- Aurora Background -->
  <div class="aurora-bg" id="auroraBg">
    <div class="aurora-orb aurora-orb--1"></div>
    <div class="aurora-orb aurora-orb--2"></div>
    <div class="aurora-orb aurora-orb--3"></div>
    <div class="aurora-orb aurora-orb--4"></div>
  </div>

  <!-- Particles -->
  <div class="particles" id="particles"></div>

  <div class="app" id="app">

    <!-- ===== Screen: Role Selection ===== -->
    <div class="screen active" id="screen-role">
      <div class="role-screen">
        <div class="app-logo">
          <div class="app-logo-text">Bridge</div>
        </div>
        <p class="app-tagline">先代の経験知を、アトツギの未来へつなぐ</p>
        <div class="role-cards">
          <div class="role-card role-card--sendai glass" onclick="enterSendai()">
            <div class="role-icon">&#x1F3EF;</div>
            <div class="role-title">先代</div>
            <div class="role-label">現経営者・創業者</div>
            <div class="role-desc">あなたの経験・価値観・<br>判断基準を記録します</div>
          </div>
          <div class="role-card role-card--atotugi glass" onclick="enterAtotugiFlow()">
            <div class="role-icon">&#x1F680;</div>
            <div class="role-title">アトツギ</div>
            <div class="role-label">後継者</div>
            <div class="role-desc">自分の立ち位置を確認し、<br>次のアクションを見つけます</div>
          </div>
        </div>
      </div>
    </div>

    <!-- ===== Screen: Sendai Interview ===== -->
    <div class="screen" id="screen-sendai">
      <div class="topbar">
        <span class="topbar-logo">Bridge</span>
        <button class="topbar-back" onclick="goToRole()">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"><path d="M19 12H5"/><path d="m12 19-7-7 7-7"/></svg>
          戻る
        </button>
      </div>
      <div class="interview-container" id="interviewContainer"></div>
    </div>

    <!-- ===== Screen: Sendai Complete ===== -->
    <div class="screen" id="screen-sendai-complete">
      <div class="topbar">
        <span class="topbar-logo">Bridge</span>
        <button class="topbar-back" onclick="goToRole()">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"><path d="M19 12H5"/><path d="m12 19-7-7 7-7"/></svg>
          トップへ
        </button>
      </div>
      <div class="interview-complete">
        <div class="complete-icon">&#x2728;</div>
        <h2 class="complete-title">インタビュー完了</h2>
        <p class="complete-desc">
          ありがとうございました。<br>
          あなたの経験と知恵が、アトツギの成長を支える<br>
          大切なナレッジとして記録されました。<br><br>
          これからアトツギがこのデータを活用し、<br>
          あなたの想いを受け継いだ経営判断を<br>
          行っていきます。
        </p>
        <button class="btn btn-primary" onclick="goToRole()">トップに戻る</button>
      </div>
    </div>

    <!-- ===== Screen: Knowledge Base (Step 0) ===== -->
    <div class="screen" id="screen-knowledge-base">
      <div class="topbar">
        <span class="topbar-logo">Bridge</span>
        <button class="topbar-back" onclick="goToRole()">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"><path d="M19 12H5"/><path d="m12 19-7-7 7-7"/></svg>
          戻る
        </button>
      </div>
      <div id="stepperKB"></div>
      <div class="kb-container" id="kbContainer"></div>
    </div>

    <!-- ===== Screen: Atotugi Survey (Step 2) ===== -->
    <div class="screen" id="screen-atotugi-survey">
      <div class="topbar">
        <span class="topbar-logo">Bridge</span>
        <button class="topbar-back" onclick="showScreen('screen-knowledge-base'); renderStepper('stepperKB', 0);">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"><path d="M19 12H5"/><path d="m12 19-7-7 7-7"/></svg>
          ナレッジベースへ
        </button>
      </div>
      <div id="stepperSurvey"></div>
      <div class="survey-container" id="surveyContainer"></div>
    </div>

    <!-- ===== Screen: Results (Step 3) ===== -->
    <div class="screen" id="screen-results">
      <div class="topbar">
        <span class="topbar-logo">Bridge</span>
        <button class="topbar-back" onclick="goToRole()">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"><path d="M19 12H5"/><path d="m12 19-7-7 7-7"/></svg>
          トップへ
        </button>
      </div>
      <div id="stepperResults"></div>
      <div class="results-container" id="resultsContainer"></div>
    </div>

    <!-- ===== Screen: Actions (Step 4) ===== -->
    <div class="screen" id="screen-actions">
      <div class="topbar">
        <span class="topbar-logo">Bridge</span>
        <button class="topbar-back" onclick="goToRole()">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"><path d="M19 12H5"/><path d="m12 19-7-7 7-7"/></svg>
          トップへ
        </button>
      </div>
      <div id="stepperActions"></div>
      <div class="actions-container" id="actionsContainer"></div>
    </div>

    <!-- ===== Screen: Knowledge Browse ===== -->
    <div class="screen" id="screen-knowledge-browse">
      <div class="topbar">
        <span class="topbar-logo">Bridge</span>
        <button class="topbar-back" onclick="showScreen('screen-knowledge-base'); renderStepper('stepperKB', 0);">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"><path d="M19 12H5"/><path d="m12 19-7-7 7-7"/></svg>
          ナレッジベースへ
        </button>
      </div>
      <div class="knowledge-browse-container" id="knowledgeBrowseContainer"></div>
    </div>

  </div>

  <script>
    // ===== Interview Data (Sendai) =====
    const interviewData = [
      {
        theme: '経営理念・価値観', themeIcon: '&#x1F3AF;',
        questions: [
          { q: 'あなたの会社・事業の一番の強みは何だと思いますか？', options: ['技術力・品質', '顧客との関係性', '人材・組織力', 'ブランド・信用力'], freeLabel: 'その強みが生まれた背景やエピソードがあれば教えてください' },
          { q: '後継者に「これだけは守ってほしい」と思うことは何ですか？', options: ['お客様第一の姿勢', '社員を大切にする文化', '品質へのこだわり', '地域への貢献'], freeLabel: '具体的に守ってほしい理由を教えてください' },
          { q: '経営で最も苦しかった経験は何ですか？', options: ['資金繰りの危機', '取引先の喪失', '人材の離脱', '市場環境の激変'], freeLabel: 'その経験から得た教訓があれば教えてください' },
          { q: '会社にとって絶対に失ってはいけない価値観は何ですか？', options: ['誠実さ・信用', '挑戦する精神', '感謝の心', '継続する力'], freeLabel: 'その価値観が大切だと感じるようになったきっかけを教えてください' }
        ]
      },
      {
        theme: '事業の方向性', themeIcon: '&#x1F4C8;',
        questions: [
          { q: '今後注力すべき事業領域はどこだと思いますか？', options: ['既存事業の深耕', '新規事業の開拓', '海外展開', 'DX・デジタル化'], freeLabel: 'その理由や背景を教えてください' },
          { q: '変革のスピードについてどう考えていますか？', options: ['慎重に進めるべき', 'バランスを取りながら', '積極的に進めるべき', '分野によって異なる'], freeLabel: 'スピード感に対する考えを具体的に教えてください' },
          { q: '後継者に「これだけはやめてほしい」判断はありますか？', options: ['借入過多の拡大路線', '人を軽視した効率化', '安易な価格競争', 'コア事業の放棄'], freeLabel: '過去にそのような失敗を見た経験があれば教えてください' }
        ]
      },
      {
        theme: '役割・権限', themeIcon: '&#x1F91D;',
        questions: [
          { q: '承継後、あなた自身はどのように関わりたいですか？', options: ['完全に退く', '相談役として残る', '一部の業務は継続', '段階的に引き継ぐ'], freeLabel: '理想の関わり方について詳しく教えてください' },
          { q: '意思決定の仕方について後継者にどう期待しますか？', options: ['トップダウンで決断', 'チームで合議', '現場の声を重視', '状況に応じて使い分け'], freeLabel: '意思決定で大切にしてほしいことを教えてください' },
          { q: '後継者に最も期待していることは何ですか？', options: ['事業を安定させること', '新しい成長を生み出すこと', '組織を強くすること', '理念を受け継ぐこと'], freeLabel: '期待の言葉があれば教えてください' }
        ]
      },
      {
        theme: '人材・組織', themeIcon: '&#x1F465;',
        questions: [
          { q: '今の組織で最も大きな課題は何ですか？', options: ['世代交代', '人材育成', 'コミュニケーション不足', '人手不足'], freeLabel: '課題の背景や具体例を教えてください' },
          { q: '後継者が最初に信頼関係を築くべき人は誰ですか？', options: ['古参の幹部', '現場のリーダー', '取引先のキーパーソン', '若手のホープ'], freeLabel: '具体的な理由を教えてください' },
          { q: '組織の信頼を得るために必要なことは何だと思いますか？', options: ['現場を知ること', '結果を出すこと', '対話を重ねること', '既存のやり方を尊重すること'], freeLabel: 'あなた自身の経験からのアドバイスを教えてください' },
          { q: '後継者へ一番伝えたいメッセージは何ですか？', options: ['焦らず着実に', '恐れずに挑戦してほしい', '人を大切にしてほしい', '自分らしくやってほしい'], freeLabel: 'メッセージの背景にある想いを自由に書いてください' }
        ]
      }
    ];

    // ===== Atotugi Survey Data (10 questions) =====
    const atotugiSurveyData = [
      {
        theme: '家業理解', themeIcon: '&#x1F3E0;', axis: 'family',
        questions: [
          { q: '家業の歴史や創業の経緯について、どの程度理解していますか？', options: ['ほとんど知らない', 'おおまかに知っている', '主要なエピソードは把握している', '詳しく理解し、自分の言葉で語れる'], freeLabel: '特に印象に残っている家業のエピソードがあれば教えてください' },
          { q: '既存の顧客や取引先との関係性を、どの程度把握していますか？', options: ['ほとんど把握していない', '主要な取引先名は知っている', '担当者レベルで面識がある', '深い信頼関係を築けている'], freeLabel: '取引先との関係で感じていることを教えてください' }
        ]
      },
      {
        theme: '社内関係構築', themeIcon: '&#x1F465;', axis: 'relations',
        questions: [
          { q: '社内のキーパーソン（古参幹部・現場リーダー）との関係性はどうですか？', options: ['ほとんど接点がない', '顔と名前は一致する程度', '業務上の対話はできている', '信頼関係を築けている'], freeLabel: 'キーパーソンとの関係で心がけていることはありますか？' },
          { q: '現場の業務をどの程度体験・理解していますか？', options: ['ほぼ未経験', '見学や説明を受けた程度', '一部の業務を体験した', '一通りの現場業務を経験した'], freeLabel: '現場体験を通じて感じたことがあれば教えてください' }
        ]
      },
      {
        theme: 'ビジョン策定', themeIcon: '&#x1F52D;', axis: 'vision',
        questions: [
          { q: '会社の将来ビジョンはどの程度明確ですか？', options: ['まだ考えられていない', 'ぼんやりとしたイメージはある', '方向性は定まっている', '具体的なビジョンを持っている'], freeLabel: '現時点で考えているビジョンや方向性があれば教えてください' },
          { q: '先代との経営方針の違いをどう捉えていますか？', options: ['違いが分からない', '違いは感じるが整理できていない', '違いを認識し建設的に捉えている', '違いを強みに変える戦略がある'], freeLabel: '方針の違いについて具体的に感じていることを教えてください' }
        ]
      },
      {
        theme: '実行力', themeIcon: '&#x1F4AA;', axis: 'execution',
        questions: [
          { q: '自分主導で進めた施策や改善の実績はありますか？', options: ['まだない', '提案はしたが実行には至っていない', '小規模な改善を実行した', '複数の施策を主導し成果を出した'], freeLabel: '具体的に取り組んだことがあれば教えてください' },
          { q: '困難な状況に直面した時、どのように対処しますか？', options: ['一人で抱え込みがち', '信頼できる人に相談する', '問題を分解して計画的に対処する', '周囲を巻き込んでチームで解決する'], freeLabel: '困難を乗り越えた経験や、心がけていることを教えてください' }
        ]
      },
      {
        theme: '先代との対話', themeIcon: '&#x1F4AC;', axis: 'dialogue',
        questions: [
          { q: '先代との経営に関する対話の頻度はどのくらいですか？', options: ['ほとんど話さない', '月に1-2回程度', '週に1回程度', '日常的に対話している'], freeLabel: '対話の中で話題になることや、難しいと感じることを教えてください' },
          { q: '先代が「守ってほしいこと」を把握していますか？', options: ['聞いたことがない', 'なんとなく察している', '一度は聞いたことがある', '明確に理解し共感している'], freeLabel: '先代の想いについて感じていることを教えてください' }
        ]
      }
    ];

    // ===== Mock: Predecessor Expectations (derived from interview) =====
    const predecessorExpectations = { family: 4.2, relations: 4.5, vision: 3.5, execution: 3.8, dialogue: 4.8 };

    // ===== Mock: Knowledge Base Stats =====
    const knowledgeBaseStats = {
      predecessorCount: 5,
      knowledgeCount: 70,
      themeCount: 4,
      themeSummaries: [
        { icon: '&#x1F3AF;', name: '経営理念・価値観', summary: '誠実さと顧客第一の精神が全先代に共通。長期的信用を最も重要な資産と位置づけています。' },
        { icon: '&#x1F4C8;', name: '事業の方向性', summary: '既存事業の深耕をベースに、段階的な新領域への挑戦を推奨。急激な方向転換は避けるべきとの共通見解。' },
        { icon: '&#x1F91D;', name: '役割・権限', summary: '段階的な権限移行が主流。完全退任より相談役として見守る姿勢を好む先代が多い傾向。' },
        { icon: '&#x1F465;', name: '人材・組織', summary: '現場との信頼構築が最優先。「まず現場に入り、汗をかくこと」が共通のアドバイスです。' }
      ]
    };

    // ===== Insight Data =====
    const insightData = {
      family: { sendai: '先代は「顧客との関係性」を最大の強みと捉え、50年かけて築いた信用を最重要視しています。', gap: '家業の深層にある「なぜこの商売を続けてきたか」を、先代との対話を通じて掘り下げることが重要です。' },
      relations: { sendai: '先代は製造部の田中さん、営業部の鈴木さんをキーパーソンとして挙げ、この二人との関係構築が最重要と考えています。', gap: '社内の信頼は「現場で汗をかくこと」から始まります。まず3ヶ月間の現場体験計画を立ててみましょう。' },
      vision: { sendai: '先代は「既存事業の深耕」を重視しつつ変革には前向き。ただし「バランスを取りながら」が基本スタンスです。', gap: 'ビジョンの方向性を明文化し、先代と共有する場を設けることで、方針の違いを建設的に活かせます。' },
      execution: { sendai: '先代は「焦らず着実に」を重視。大きな施策は段階的に分解し、小さな成果を積み重ねるアプローチを推奨しています。', gap: '90日間の短期アクションプランを作成し、小さな成功体験を積むことが実行力の証明につながります。' },
      dialogue: { sendai: '先代は「相談役として残りたい」と考えており、伝えきれていない想いがあります。定期的な対話の場を求めています。', gap: '対話の「頻度」だけでなく「深さ」が重要です。先代の「守ってほしいこと」について、じっくり聴く時間を作りましょう。' }
    };

    // ===== Action Templates =====
    const actionTemplates = {
      family: { title: '家業の歴史をヒアリングする', desc: '先代や古参社員に家業の歴史・転機・顧客との関係性について系統的にヒアリングを行い、ナレッジとして整理します。', time: '2週間', phase: 1 },
      relations: { title: 'キーパーソンとの1on1を開始する', desc: '古参幹部・現場リーダーとの定期的な1on1ミーティングを設定し、信頼関係の基盤を構築します。', time: '1週間で開始', phase: 1 },
      vision: { title: 'ビジョンステートメントを作成する', desc: '自分なりの将来ビジョンを明文化し、先代とのすり合わせミーティングを設定します。', time: '1ヶ月', phase: 2 },
      execution: { title: '小規模改善プロジェクトを立ち上げる', desc: '現場で見つけた改善ポイントを1つ選び、自分主導で小規模な改善を実行します。', time: '2週間', phase: 1 },
      dialogue: { title: '先代との定期対話を制度化する', desc: '週1回の定期対話の場を設け、経営方針・価値観・期待について体系的に聴き取ります。', time: '即日開始', phase: 1 }
    };

    // ===== State =====
    let currentSendaiQ = 0;
    const totalSendaiQ = interviewData.reduce((s, t) => s + t.questions.length, 0);
    const sendaiAnswers = {};

    let currentAtotugiQ = 0;
    const totalAtotugiQ = atotugiSurveyData.reduce((s, t) => s + t.questions.length, 0);
    const atotugiAnswers = {};
    let atotugiScores = {};

    // ===== Screen Navigation =====
    function showScreen(id) {
      document.querySelectorAll('.screen').forEach(s => s.classList.remove('active'));
      document.getElementById(id).classList.add('active');
      window.scrollTo(0, 0);
    }

    function goToRole() {
      showScreen('screen-role');
      document.getElementById('auroraBg').className = 'aurora-bg';
    }

    // ===== Stepper =====
    function renderStepper(containerId, activeStep) {
      const steps = ['ナレッジ確認', '自己診断', '結果', 'アクション'];
      const el = document.getElementById(containerId);
      el.innerHTML = `<div class="stepper">${steps.map((s, i) => {
        let cls = '';
        if (i < activeStep) cls = 'completed';
        else if (i === activeStep) cls = 'active';
        const lineCls = i < activeStep ? 'completed' : '';
        const line = i < steps.length - 1 ? `<div class="stepper-line ${lineCls}"></div>` : '';
        return `<div class="stepper-step ${cls}"><div class="stepper-num">${i < activeStep ? '&#x2713;' : i + 1}</div><span>${s}</span></div>${line}`;
      }).join('')}</div>`;
    }

    // ===== Sendai Flow =====
    function enterSendai() {
      document.getElementById('auroraBg').className = 'aurora-bg mode-sendai';
      showScreen('screen-sendai');
      currentSendaiQ = 0;
      renderSendaiQuestion();
    }

    function getSendaiQuestionData(index) {
      let i = 0;
      for (const theme of interviewData) {
        for (const question of theme.questions) {
          if (i === index) return { ...question, theme: theme.theme, themeIcon: theme.themeIcon };
          i++;
        }
      }
      return null;
    }

    function renderSendaiQuestion() {
      const container = document.getElementById('interviewContainer');
      const data = getSendaiQuestionData(currentSendaiQ);
      if (!data) { showScreen('screen-sendai-complete'); return; }
      const progress = (currentSendaiQ / totalSendaiQ) * 100;
      const answer = sendaiAnswers[currentSendaiQ] || {};
      container.innerHTML = `
        <div class="interview-progress">
          <div class="interview-progress-bar"><div class="interview-progress-fill interview-progress-fill--warm" style="width:${progress}%"></div></div>
          <div class="interview-progress-text"><span>${data.theme}</span><span>${currentSendaiQ+1} / ${totalSendaiQ}</span></div>
        </div>
        <div class="interview-theme-label interview-theme-label--warm">${data.themeIcon} ${data.theme}</div>
        <div class="interview-question-num">QUESTION ${String(currentSendaiQ+1).padStart(2,'0')}</div>
        <h2 class="interview-question">${data.q}</h2>
        <div class="interview-options">
          ${data.options.map((opt, idx) => `
            <div class="interview-option ${answer.selected === idx ? 'selected' : ''}" onclick="selectSendaiOption(${idx})">
              <div class="interview-option-radio"></div><span>${opt}</span>
            </div>
          `).join('')}
        </div>
        <div class="interview-textarea-label">${data.freeLabel}</div>
        <textarea class="interview-textarea" id="sendaiFreeText" placeholder="自由に記入してください..." oninput="saveSendaiFreeText(this.value)">${answer.freeText||''}</textarea>
        <div class="interview-nav">
          <button class="btn btn-secondary" onclick="prevSendaiQ()" ${currentSendaiQ===0?'disabled':''}>
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"><path d="M19 12H5"/><path d="m12 19-7-7 7-7"/></svg> 前へ
          </button>
          <button class="btn btn-primary" onclick="nextSendaiQ()">
            ${currentSendaiQ===totalSendaiQ-1?'完了する':'次へ'}
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"><path d="M5 12h14"/><path d="m12 5 7 7-7 7"/></svg>
          </button>
        </div>
      `;
    }

    function selectSendaiOption(idx) { if(!sendaiAnswers[currentSendaiQ]) sendaiAnswers[currentSendaiQ]={}; sendaiAnswers[currentSendaiQ].selected=idx; renderSendaiQuestion(); }
    function saveSendaiFreeText(v) { if(!sendaiAnswers[currentSendaiQ]) sendaiAnswers[currentSendaiQ]={}; sendaiAnswers[currentSendaiQ].freeText=v; }
    function nextSendaiQ() { if(currentSendaiQ<totalSendaiQ-1){currentSendaiQ++;renderSendaiQuestion();window.scrollTo({top:0,behavior:'smooth'});}else{showScreen('screen-sendai-complete');} }
    function prevSendaiQ() { if(currentSendaiQ>0){currentSendaiQ--;renderSendaiQuestion();window.scrollTo({top:0,behavior:'smooth'});} }

    // ===== Atotugi Flow =====
    function enterAtotugiFlow() {
      document.getElementById('auroraBg').className = 'aurora-bg mode-atotugi';
      showScreen('screen-knowledge-base');
      renderStepper('stepperKB', 0);
      renderKBScreen();
    }

    // ===== Knowledge Base Screen =====
    function renderKBScreen() {
      const c = document.getElementById('kbContainer');
      c.innerHTML = `
        <h2 class="kb-title">蓄積されたナレッジ</h2>
        <p class="kb-subtitle">複数の先代経営者から集められた経験知が、あなたの経営判断をサポートします。</p>
        <div class="kb-stats">
          <div class="kb-stat glass">
            <div class="kb-stat-num">${knowledgeBaseStats.predecessorCount}</div>
            <div class="kb-stat-label">名の先代</div>
          </div>
          <div class="kb-stat glass">
            <div class="kb-stat-num">${knowledgeBaseStats.knowledgeCount}</div>
            <div class="kb-stat-label">件のナレッジ</div>
          </div>
          <div class="kb-stat glass">
            <div class="kb-stat-num">${knowledgeBaseStats.themeCount}</div>
            <div class="kb-stat-label">テーマ</div>
          </div>
        </div>
        <div class="kb-themes">
          ${knowledgeBaseStats.themeSummaries.map(t => `
            <div class="kb-theme-card glass">
              <div class="kb-theme-icon">${t.icon}</div>
              <div class="kb-theme-name">${t.name}</div>
              <div class="kb-theme-summary">${t.summary}</div>
            </div>
          `).join('')}
        </div>
        <div class="kb-highlight glass">
          <div class="kb-highlight-title">&#x2728; あなたの先代（山田太郎）のインタビュー完了済み</div>
          <div class="kb-highlight-desc">14問すべてに回答済み。先代の経験と価値観が詳細に記録されています。</div>
        </div>
        <div style="display:flex; gap:12px; justify-content:center; flex-wrap:wrap;">
          <button class="btn btn-primary btn-primary--cool" onclick="startAtotugiSurvey()">
            自分の立ち位置を確認する
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"><path d="M5 12h14"/><path d="m12 5 7 7-7 7"/></svg>
          </button>
          <button class="btn btn-outline-cool" onclick="showKnowledgeBrowse()">先代の知恵を閲覧する</button>
        </div>
      `;
    }

    // ===== Knowledge Browse =====
    function showKnowledgeBrowse() {
      showScreen('screen-knowledge-browse');
      renderKnowledgeBrowse();
    }

    function renderKnowledgeBrowse() {
      const container = document.getElementById('knowledgeBrowseContainer');
      const iconClasses = ['knowledge-theme-icon--1','knowledge-theme-icon--2','knowledge-theme-icon--3','knowledge-theme-icon--4'];
      const mockAnswers = getMockAnswers();

      container.innerHTML = `
        <h2 class="kb-title" style="margin-bottom:4px;">先代の知恵</h2>
        <p class="kb-subtitle">先代のインタビュー回答をテーマ別に閲覧できます。</p>
        <div class="knowledge-themes">
          ${interviewData.map((theme, ti) => {
            let questionIdx = 0;
            for (let t = 0; t < ti; t++) questionIdx += interviewData[t].questions.length;
            return `
              <div class="knowledge-theme glass" id="kb-theme-${ti}">
                <div class="knowledge-theme-header" onclick="document.getElementById('kb-theme-${ti}').classList.toggle('open')">
                  <div class="knowledge-theme-left">
                    <div class="knowledge-theme-icon ${iconClasses[ti]}">${theme.themeIcon}</div>
                    <div>
                      <div class="knowledge-theme-name">${theme.theme}</div>
                      <div class="knowledge-theme-count">${theme.questions.length}件の回答</div>
                    </div>
                  </div>
                  <svg class="knowledge-theme-arrow" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"><path d="m6 9 6 6 6-6"/></svg>
                </div>
                <div class="knowledge-theme-body">
                  ${theme.questions.map((q, qi) => {
                    const globalIdx = questionIdx + qi;
                    const mock = mockAnswers[globalIdx];
                    return `
                      <div class="knowledge-item">
                        <div class="knowledge-item-q">${q.q}</div>
                        <div class="knowledge-item-type">選択回答</div>
                        <div class="knowledge-item-a">${q.options[mock.selected]}</div>
                        <div class="knowledge-item-free">${mock.freeText}</div>
                      </div>
                    `;
                  }).join('')}
                </div>
              </div>
            `;
          }).join('')}
        </div>
      `;
    }

    function getMockAnswers() {
      return {
        0: { selected: 1, freeText: '創業以来50年、一度も取引先を裏切ったことがない。その積み重ねが今の信用につながっている。' },
        1: { selected: 0, freeText: 'お客様の声を直接聞く時間だけは削ってはいけない。それがうちの商売の原点だ。' },
        2: { selected: 0, freeText: 'リーマンショックの時、取引先が前払いしてくれて乗り越えた。日頃の信用の大切さを痛感した。' },
        3: { selected: 0, freeText: '誠実さを失ったら、何も残らない。短期的な利益より、長期的な信頼。' },
        4: { selected: 0, freeText: '既存のお客様をもっと深く理解し、新しい価値を提供していくことが最優先。' },
        5: { selected: 1, freeText: '3年先を見ながら、半年ごとに検証するくらいのペースが良い。' },
        6: { selected: 0, freeText: '知り合いの会社が借入で急拡大して潰れた。身の丈に合った成長を大切に。' },
        7: { selected: 3, freeText: 'まずは日常業務から離れ、大きな判断の時だけ相談してもらう形が理想。' },
        8: { selected: 3, freeText: '平時はチームに任せ、有事は自分で決断する。その見極めが経営者の仕事。' },
        9: { selected: 1, freeText: '新しい成長を作ってほしい。ただし、お客様と社員を大切にしながら。' },
        10: { selected: 0, freeText: 'ベテラン社員の高齢化が進んでいる。若手への技術伝承が急務。' },
        11: { selected: 0, freeText: '製造部の田中さんと営業部の鈴木さん。この二人を味方につけられるかが最初の関門。' },
        12: { selected: 0, freeText: 'まず現場で汗をかくこと。3ヶ月現場に入れば、見える景色が変わる。' },
        13: { selected: 0, freeText: 'まずは足元を固めてほしい。その上で、自分なりのビジョンを描いてくれたら嬉しい。' }
      };
    }

    // ===== Atotugi Survey =====
    function startAtotugiSurvey() {
      currentAtotugiQ = 0;
      showScreen('screen-atotugi-survey');
      renderStepper('stepperSurvey', 1);
      renderAtotugiQuestion();
    }

    function getAtotugiQuestionData(index) {
      let i = 0;
      for (const theme of atotugiSurveyData) {
        for (const question of theme.questions) {
          if (i === index) return { ...question, theme: theme.theme, themeIcon: theme.themeIcon, axis: theme.axis };
          i++;
        }
      }
      return null;
    }

    function renderAtotugiQuestion() {
      const container = document.getElementById('surveyContainer');
      const data = getAtotugiQuestionData(currentAtotugiQ);
      if (!data) { finishSurvey(); return; }
      const progress = (currentAtotugiQ / totalAtotugiQ) * 100;
      const answer = atotugiAnswers[currentAtotugiQ] || {};
      container.innerHTML = `
        <div class="interview-progress">
          <div class="interview-progress-bar"><div class="interview-progress-fill interview-progress-fill--cool" style="width:${progress}%"></div></div>
          <div class="interview-progress-text"><span>${data.theme}</span><span>${currentAtotugiQ+1} / ${totalAtotugiQ}</span></div>
        </div>
        <div class="interview-theme-label interview-theme-label--cool">${data.themeIcon} ${data.theme}</div>
        <div class="interview-question-num">QUESTION ${String(currentAtotugiQ+1).padStart(2,'0')}</div>
        <h2 class="interview-question">${data.q}</h2>
        <div class="interview-options">
          ${data.options.map((opt, idx) => `
            <div class="interview-option interview-option--cool ${answer.selected===idx?'selected':''}" onclick="selectAtotugiOption(${idx})">
              <div class="interview-option-radio"></div><span>${opt}</span>
            </div>
          `).join('')}
        </div>
        <div class="interview-textarea-label">${data.freeLabel}</div>
        <textarea class="interview-textarea interview-textarea--cool" id="atotugiFreeTxt" placeholder="自由に記入してください..." oninput="saveAtotugiFreeTxt(this.value)">${answer.freeText||''}</textarea>
        <div class="interview-nav">
          <button class="btn btn-secondary" onclick="prevAtotugiQ()" ${currentAtotugiQ===0?'disabled':''}>
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"><path d="M19 12H5"/><path d="m12 19-7-7 7-7"/></svg> 前へ
          </button>
          <button class="btn btn-primary btn-primary--cool" onclick="nextAtotugiQ()">
            ${currentAtotugiQ===totalAtotugiQ-1?'結果を見る':'次へ'}
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"><path d="M5 12h14"/><path d="m12 5 7 7-7 7"/></svg>
          </button>
        </div>
      `;
    }

    function selectAtotugiOption(idx) { if(!atotugiAnswers[currentAtotugiQ]) atotugiAnswers[currentAtotugiQ]={}; atotugiAnswers[currentAtotugiQ].selected=idx; renderAtotugiQuestion(); }
    function saveAtotugiFreeTxt(v) { if(!atotugiAnswers[currentAtotugiQ]) atotugiAnswers[currentAtotugiQ]={}; atotugiAnswers[currentAtotugiQ].freeText=v; }
    function nextAtotugiQ() { if(currentAtotugiQ<totalAtotugiQ-1){currentAtotugiQ++;renderAtotugiQuestion();window.scrollTo({top:0,behavior:'smooth'});}else{finishSurvey();} }
    function prevAtotugiQ() { if(currentAtotugiQ>0){currentAtotugiQ--;renderAtotugiQuestion();window.scrollTo({top:0,behavior:'smooth'});} }

    // ===== Calculate Scores =====
    function calculateAxisScores() {
      const axes = ['family','relations','vision','execution','dialogue'];
      const scores = {};
      let qIdx = 0;
      for (const theme of atotugiSurveyData) {
        let axisSum = 0;
        let axisCount = 0;
        for (const q of theme.questions) {
          const a = atotugiAnswers[qIdx];
          const val = a && a.selected !== undefined ? a.selected + 1 : 2; // 0-3 mapped to 1-4
          axisSum += val;
          axisCount++;
          qIdx++;
        }
        scores[theme.axis] = axisSum / axisCount;
      }
      return scores;
    }

    function finishSurvey() {
      atotugiScores = calculateAxisScores();
      showScreen('screen-results');
      renderStepper('stepperResults', 2);
      renderResultsScreen();
    }

    // ===== Results Screen =====
    function renderResultsScreen() {
      const c = document.getElementById('resultsContainer');
      const axes = ['family','relations','vision','execution','dialogue'];
      const axisNames = { family:'家業理解', relations:'社内関係構築', vision:'ビジョン策定', execution:'実行力', dialogue:'先代との対話' };

      // Find best and worst gaps
      let maxGap = -1, maxGapAxis = '';
      let minGap = 99, minGapAxis = '';
      axes.forEach(a => {
        const gap = Math.abs(predecessorExpectations[a] - atotugiScores[a]);
        if (gap > maxGap) { maxGap = gap; maxGapAxis = a; }
        if (gap < minGap) { minGap = gap; minGapAxis = a; }
      });

      c.innerHTML = `
        <h2 class="results-section-title"><span>&#x1F4CA;</span> 診断結果</h2>

        <!-- Dual Radar -->
        <div class="dual-radar-container">
          <svg class="dual-radar" id="dualRadar" viewBox="0 0 340 340"></svg>
        </div>
        <div class="radar-legend">
          <div class="radar-legend-item"><div class="radar-legend-dot radar-legend-dot--sendai"></div><span>先代の期待値</span></div>
          <div class="radar-legend-item"><div class="radar-legend-dot radar-legend-dot--atotugi"></div><span>あなたの現在地</span></div>
        </div>

        <!-- Gap Bars -->
        <h3 class="results-section-title" style="font-size:1rem;"><span>&#x1F4CF;</span> ギャップ分析</h3>
        <div class="gap-bars">
          ${axes.map(a => {
            const sendaiVal = predecessorExpectations[a];
            const atotugiVal = atotugiScores[a];
            const gap = Math.abs(sendaiVal - atotugiVal);
            let badgeCls = 'gap-bar-badge--good', badgeText = 'Good';
            if (gap > 2) { badgeCls = 'gap-bar-badge--danger'; badgeText = 'Alert'; }
            else if (gap > 1) { badgeCls = 'gap-bar-badge--warn'; badgeText = 'Caution'; }
            return `
              <div class="gap-bar-item glass">
                <div class="gap-bar-label">
                  <span>${axisNames[a]}</span>
                  <span class="gap-bar-badge ${badgeCls}">${badgeText} (Gap: ${gap.toFixed(1)})</span>
                </div>
                <div class="gap-bar-track">
                  <div class="gap-bar-fill-sendai" style="width:${(sendaiVal/5)*100}%"></div>
                  <div class="gap-bar-fill-atotugi" style="width:${(atotugiVal/5)*100}%"></div>
                </div>
                <div class="gap-bar-values">
                  <span>先代: ${sendaiVal.toFixed(1)}</span>
                  <span>あなた: ${atotugiVal.toFixed(1)}</span>
                </div>
              </div>
            `;
          }).join('')}
        </div>

        <!-- Insights -->
        <h3 class="results-section-title" style="font-size:1rem;"><span>&#x1F4A1;</span> 軸別インサイト</h3>
        <div class="insight-cards">
          ${axes.map(a => `
            <div class="insight-card glass">
              <div class="insight-card-axis" style="color:var(--cyan-light);">&#x25C6; ${axisNames[a]}</div>
              <div class="insight-row"><span class="insight-label insight-label--sendai">先代の視点</span><span class="insight-text">${insightData[a].sendai}</span></div>
              <div class="insight-row"><span class="insight-label insight-label--gap">ギャップ</span><span class="insight-text">${insightData[a].gap}</span></div>
            </div>
          `).join('')}
        </div>

        <!-- Summary Cards -->
        <div class="summary-card glass summary-card--strength">
          <div class="summary-card-title" style="color:var(--green-light);">&#x2705; 強み：${axisNames[minGapAxis]}</div>
          <div class="summary-card-body">この軸は先代の期待値との差が最も小さく（Gap: ${minGap.toFixed(1)}）、あなたの強みと言えます。この基盤を活かして他の軸の改善にもつなげていきましょう。</div>
        </div>
        <div class="summary-card glass summary-card--warning">
          <div class="summary-card-title" style="color:#f87171;">&#x26A0; 要注意：${axisNames[maxGapAxis]}</div>
          <div class="summary-card-body">この軸は先代の期待値との差が最も大きく（Gap: ${maxGap.toFixed(1)}）、優先的に取り組む必要があります。具体的なアクションプランを確認しましょう。</div>
        </div>

        <div class="results-nav">
          <button class="btn btn-primary btn-primary--cool" onclick="goToActions()">
            次のステップへ
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"><path d="M5 12h14"/><path d="m12 5 7 7-7 7"/></svg>
          </button>
        </div>
      `;

      renderDualRadar();
    }

    // ===== Dual Radar Chart =====
    function renderDualRadar() {
      const svg = document.getElementById('dualRadar');
      const cx = 170, cy = 170, maxR = 120;
      const axes = ['family','relations','vision','execution','dialogue'];
      const labels = ['家業理解','社内関係','ビジョン','実行力','対話'];
      const n = axes.length;
      let html = '';

      // Grid
      for (let level = 1; level <= 5; level++) {
        const r = (level / 5) * maxR;
        let pts = '';
        for (let i = 0; i < n; i++) {
          const angle = (Math.PI * 2 * i / n) - Math.PI / 2;
          pts += `${cx + r * Math.cos(angle)},${cy + r * Math.sin(angle)} `;
        }
        html += `<polygon points="${pts}" fill="none" stroke="rgba(0,0,0,0.08)" stroke-width="1"/>`;
      }

      // Axis lines
      for (let i = 0; i < n; i++) {
        const angle = (Math.PI * 2 * i / n) - Math.PI / 2;
        html += `<line x1="${cx}" y1="${cy}" x2="${cx + maxR * Math.cos(angle)}" y2="${cy + maxR * Math.sin(angle)}" stroke="rgba(0,0,0,0.08)" stroke-width="1"/>`;
      }

      // Sendai polygon (amber)
      let sendaiPts = '';
      for (let i = 0; i < n; i++) {
        const angle = (Math.PI * 2 * i / n) - Math.PI / 2;
        const r = (predecessorExpectations[axes[i]] / 5) * maxR;
        sendaiPts += `${cx + r * Math.cos(angle)},${cy + r * Math.sin(angle)} `;
      }
      html += `<polygon points="${sendaiPts}" fill="rgba(217,119,6,0.12)" stroke="var(--amber)" stroke-width="2" stroke-dasharray="6,3"/>`;

      // Atotugi polygon (cyan)
      let atotugiPts = '';
      for (let i = 0; i < n; i++) {
        const angle = (Math.PI * 2 * i / n) - Math.PI / 2;
        const r = (atotugiScores[axes[i]] / 5) * maxR;
        atotugiPts += `${cx + r * Math.cos(angle)},${cy + r * Math.sin(angle)} `;
      }
      html += `<polygon points="${atotugiPts}" fill="rgba(8,145,178,0.12)" stroke="var(--cyan)" stroke-width="2"/>`;

      // Dots + Labels
      for (let i = 0; i < n; i++) {
        const angle = (Math.PI * 2 * i / n) - Math.PI / 2;
        // Sendai dot
        const sr = (predecessorExpectations[axes[i]] / 5) * maxR;
        html += `<circle cx="${cx+sr*Math.cos(angle)}" cy="${cy+sr*Math.sin(angle)}" r="4" fill="var(--amber-light)" stroke="var(--dark-bg)" stroke-width="2"/>`;
        // Atotugi dot
        const ar = (atotugiScores[axes[i]] / 5) * maxR;
        html += `<circle cx="${cx+ar*Math.cos(angle)}" cy="${cy+ar*Math.sin(angle)}" r="4" fill="var(--cyan-light)" stroke="var(--dark-bg)" stroke-width="2"/>`;
        // Label
        const lr = maxR + 28;
        const lx = cx + lr * Math.cos(angle);
        const ly = cy + lr * Math.sin(angle);
        html += `<text x="${lx}" y="${ly}" text-anchor="middle" dominant-baseline="middle" fill="var(--text-secondary)" font-size="11" font-family="var(--font-jp)">${labels[i]}</text>`;
      }

      svg.innerHTML = html;
    }

    // ===== Actions Screen =====
    function goToActions() {
      showScreen('screen-actions');
      renderStepper('stepperActions', 3);
      renderActionsScreen();
    }

    function renderActionsScreen() {
      const c = document.getElementById('actionsContainer');
      const axes = ['family','relations','vision','execution','dialogue'];
      const axisNames = { family:'家業理解', relations:'社内関係構築', vision:'ビジョン策定', execution:'実行力', dialogue:'先代との対話' };

      // Sort axes by gap descending
      const sorted = axes.map(a => ({
        axis: a,
        gap: Math.abs(predecessorExpectations[a] - atotugiScores[a])
      })).sort((a, b) => b.gap - a.gap);

      c.innerHTML = `
        <h2 class="results-section-title"><span>&#x1F3AF;</span> ネクストアクション</h2>

        <!-- Priority Action Cards -->
        <h3 class="results-section-title" style="font-size:1rem;"><span>&#x1F4CB;</span> 優先アクション</h3>
        <div class="action-cards">
          ${sorted.map((item, idx) => {
            const t = actionTemplates[item.axis];
            const priorityCls = idx < 2 ? 'action-card-priority--high' : 'action-card-priority--mid';
            const priorityText = idx < 2 ? 'HIGH' : 'MID';
            return `
              <div class="action-card glass">
                <div class="action-card-header">
                  <span class="action-card-axis">${axisNames[item.axis]}</span>
                  <span class="action-card-priority ${priorityCls}">${priorityText}</span>
                </div>
                <div class="action-card-title">${t.title}</div>
                <div class="action-card-desc">${t.desc}</div>
                <div class="action-card-meta">
                  <span>&#x23F0; 目安: ${t.time}</span>
                  <span>&#x1F4CA; Gap: ${item.gap.toFixed(1)}</span>
                  <span>&#x1F4C5; Phase ${t.phase}</span>
                </div>
              </div>
            `;
          }).join('')}
        </div>

        <!-- Timeline -->
        <h3 class="results-section-title" style="font-size:1rem;"><span>&#x1F5D3;</span> 30/60/90日タイムライン</h3>
        <div class="timeline">
          <div class="timeline-phase timeline-phase--1">
            <div class="timeline-dot"></div>
            <div class="timeline-phase-header">Phase 1: 基盤づくり</div>
            <div class="timeline-phase-period">Day 1 - 30</div>
            <ul class="timeline-phase-items">
              <li>先代との定期対話の場を設定する（週1回）</li>
              <li>社内キーパーソンとの1on1を開始する</li>
              <li>現場業務の体験期間を設ける（最低2週間）</li>
              <li>家業の歴史をヒアリングし、記録する</li>
            </ul>
          </div>
          <div class="timeline-phase timeline-phase--2">
            <div class="timeline-dot"></div>
            <div class="timeline-phase-header">Phase 2: 関係構築</div>
            <div class="timeline-phase-period">Day 31 - 60</div>
            <ul class="timeline-phase-items">
              <li>主要取引先への挨拶回り・関係構築</li>
              <li>自分のビジョンステートメントを作成する</li>
              <li>先代とのビジョンすり合わせミーティング</li>
              <li>小規模な改善プロジェクトを1つ立ち上げる</li>
            </ul>
          </div>
          <div class="timeline-phase timeline-phase--3">
            <div class="timeline-dot"></div>
            <div class="timeline-phase-header">Phase 3: 実行と検証</div>
            <div class="timeline-phase-period">Day 61 - 90</div>
            <ul class="timeline-phase-items">
              <li>改善プロジェクトの成果を検証・共有する</li>
              <li>中期経営方針（3年計画）のドラフトを作成する</li>
              <li>Bridgeで再診断し、成長を可視化する</li>
              <li>先代と「次の100日」の計画を共有する</li>
            </ul>
          </div>
        </div>

        <!-- Sendai Message -->
        <div class="sendai-message">
          <div class="sendai-message-title">&#x1F4AC; 先代からの励ましメッセージ</div>
          <div class="sendai-message-body">
            「焦らず着実に、でも恐れずに挑戦してほしい。お客様を大切にし、社員を大切にする姿勢さえ持っていれば、あとは自分らしくやってくれていい。私の時代とは違うやり方が必要な時代だと理解している。あなたなら大丈夫だと信じている。」
          </div>
        </div>

        <div class="actions-nav">
          <button class="btn btn-outline-cool" onclick="showKnowledgeBrowse()">先代の知恵を確認する</button>
          <button class="btn btn-outline-cool" onclick="startAtotugiSurvey()">もう一度診断する</button>
          <button class="btn btn-secondary" onclick="goToRole()">トップに戻る</button>
        </div>
      `;
    }

    // ===== Particles =====
    function createParticles() {
      const container = document.getElementById('particles');
      for (let i = 0; i < 20; i++) {
        const p = document.createElement('div');
        p.className = 'particle';
        const size = Math.random() * 3 + 1;
        const colors = ['var(--amber)','var(--coral)','var(--cyan)','var(--indigo)'];
        p.style.cssText = `width:${size}px;height:${size}px;left:${Math.random()*100}%;background:${colors[Math.floor(Math.random()*colors.length)]};opacity:${Math.random()*0.25+0.08};animation-duration:${Math.random()*15+10}s;animation-delay:${Math.random()*-20}s;`;
        container.appendChild(p);
      }
    }

    createParticles();
  </script>
</body>
</html>
